---

# Ansible playbook to import artifacts into Nexus Repository

- name: Import artifacts from Nexus Repository example
  hosts: localhost
  vars:
    vault_address: "{{ lookup('ansible.builtin.env', 'VAULT_ADDR', default=Undefined) }}"
    vault_token: "{{ lookup('ansible.builtin.env', 'VAULT_TOKEN', default=Undefined) }}"

  roles:

  tasks:
    # Import repository
    - name: Import artifacts from Nexus Repository
      ansible.builtin.include_role:
        name: nexus-repository
      vars:
        action : import_artifacts
        nexus_repository_name : "files"
        nexus_repository_folder : ""
        source_folder : "/tmp/files"
        nexus_repository: 
          # address:  # Get from Vault
          # username: # Get from Vault
          # password: # Get from Vault
          secrets:
            vault_id: "192-168-29-90" # unique id to identify instance in Vault

    - name: Show information message
      debug:
        msg:
          - "Import completed to '{{ nexus_repository_folder }}' of '{{ nexus_repoository.address }}'..."
          - "Source folder: '{{ source_folder }}'"
