---
# Upload artifacts to repository
# This playbook will upload files from a folder to the artifact repository.

- name: Upload artifacts to repository
  hosts: localhost
  vars:
    vault_address: "{{ lookup('ansible.builtin.env', 'VAULT_ADDR', default=Undefined) }}"
    vault_token: "{{ lookup('ansible.builtin.env', 'VAULT_TOKEN', default=Undefined) }}"

  tasks:
    # Information message
    - name: Information message
      ansible.builtin.debug:
        msg:
          - "#########################################################"
          - "#########################################################"
          - "Upload artifacts to repository"
          - "#########################################################"
          - "#########################################################"

    # Download folder
    - name: Upload artifacts to repository...
      ansible.builtin.include_role:
        name: nexus-repository
      vars:
        action: "import_artifacts"
        nexus_repository_name       : "blauwe_disk"
        nexus_repository_folder     : "containers"
        source_folder               : "/tmp/exported_containers"
        nexus_repository:
          # address:  # Get from Vault
          # username: # Get from Vault
          # password: # Get from Vault
          secrets:
            secret_name: "10-42-1-200" # unique id to identify instance in Vault

    # Upload completed
    - name: Show information message
      ansible.builtin.debug:
        msg:
          - "Upload completed..."
          